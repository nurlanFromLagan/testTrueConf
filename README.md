Здравствуйте! 

Особых изменений не вносил, в основном разбил на более понятное представление с моделью и контроллером.



